<!DOCTYPE html>
<html lang="en" style='background: white'>
<head>
  <meta charset="utf-8">
  <meta name=viewport
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#E91E63">

  <link rel="manifest" href="/manifest.json">
  <link rel="shortcut icon" href="/static/favicon.ico?v3">
  <link rel="icon" type="image/png" sizes="96x96" href="/static/favicon-96x96.png">

</head>

<body style='background: white'>
<div id="douma">
  <div style="
          float: none;
          padding-top: 144px;
      ">
    <img src="/static/loading-logo.png" style="
            margin-left: auto;
            margin-right: auto;
            display: block;
            height: 80px;
        ">
    <script>
      var unregisterSW = function () {
        console.log('[sw] unregister all starting')

        navigator.serviceWorker.getRegistrations()
          .then(function (registrations) {
            var allUnregisters = registrations.map(r => r.unregister())
            return Promise.all(allUnregisters)
              .then(function (result) {
                console.log(`[sw] unregister all complete (${result.length} ServiceWorkers unregistered)`)
                document.getElementById('done').classList.remove('invisible')
                document.getElementById('do').classList.add('invisible')
              })
              .catch((e) => {
                console.error(errors)
              })
          })
      }
    </script>
    <style>
      .invisible {
        display: none
      }
    </style>
    <div style='font-family: sans-serif; color: grey; text-align: center; margin: 0 auto; width: 80%'>
      <div>Click the button below to reset the offline mode. You will not lose any data already saved.</div>
      <div style="text-align: center; padding-top: 3em; font-size: 1.5em; cursor: pointer; color: orange;">
        <button id='do' onclick="unregisterSW()" style="font-size: 1.5em;">Click to reset offline functionality</button>
        <div id="done" class="invisible">Done. <a href="/">Restart application</a></div>
        <div id="errors" class="invisible" style="color: red;">Error removing offline functionality. Please check browser console.</a></div>
      </div>

    </div>

  </div>
</div>
</body>
</html>
